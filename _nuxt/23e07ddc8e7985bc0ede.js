(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{144:function(t,a,e){var n=e(150);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,e(23).default)("2082d03f",n,!0,{})},145:function(t,a,e){var n=e(152);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,e(23).default)("a01d5c92",n,!0,{})},149:function(t,a,e){"use strict";var n=e(144);e.n(n).a},150:function(t,a,e){(t.exports=e(22)(!1)).push([t.i,"\ntable .v-menu{width:100px\n}",""])},151:function(t,a,e){"use strict";var n=e(145);e.n(n).a},152:function(t,a,e){(t.exports=e(22)(!1)).push([t.i,"\n.v-tooltip[data-v-2f18ba0f]{position:static\n}\n.diagram[data-v-2f18ba0f]{overflow-x:scroll;background:#fff;will-change:transform\n}\n.diagram table[data-v-2f18ba0f]{border-collapse:collapse;will-change:transform\n}\n.diagram td[data-v-2f18ba0f]{padding:4px 3px;font-size:13px;border-top:1px solid #ccc;min-width:20px;text-align:center\n}\ntd.week[data-v-2f18ba0f]{border-left:1px solid #ebebeb;text-align:left;padding-left:5px\n}\ntd.holiday[data-v-2f18ba0f]{background:#ebebeb\n}\ntd.job[data-v-2f18ba0f]{background:#219196\n}\ntd.today[data-v-2f18ba0f]{background:#666!important;color:#fff;border-bottom:1px solid #666\n}\n.category td[data-v-2f18ba0f]{background:#647d9b;color:#fff;font-size:14px;padding:5px;text-align:left\n}\ntd.name[data-v-2f18ba0f]{min-width:200px;position:-webkit-sticky;position:sticky;left:0;background:hsla(0,0%,100%,.8)\n}\ntd.descr[data-v-2f18ba0f]{padding:5px;text-align:left\n}\ntd.date[data-v-2f18ba0f]{min-width:86px\n}\ntd.spacer[data-v-2f18ba0f]{background:#fff\n}\ntd.done[data-v-2f18ba0f]{background:#9adcbb\n}\ntd.done[data-v-2f18ba0f],td.progress[data-v-2f18ba0f]{white-space:nowrap;color:#000\n}\ntd.progress[data-v-2f18ba0f]{background:#fff7ae\n}\ntd.waiting[data-v-2f18ba0f]{background:#d0d0d0;white-space:nowrap;color:#000\n}\ntd.check-btn[data-v-2f18ba0f]{padding:0\n}\ntd.check-btn .v-btn[data-v-2f18ba0f]{margin:0\n}\ntd.check-btn .v-icon[data-v-2f18ba0f]{color:green\n}",""])},156:function(t,a,e){"use strict";e(40);var n=e(4),s=e.n(n),i=(e(41),e(82),{props:["value","label"],data:function(){return{date:this.value&&this.value.split("T")[0],menu:!1}},methods:{update:function(){this.$emit("input",this.date)},clear:function(){this.$emit("input",null)}},computed:{formated:function(){return this.date?new Date(this.date).toLocaleDateString():""}},watch:{value:function(t){this.date=t}}}),o=(e(149),e(3)),l=Object(o.a)(i,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-menu",{attrs:{lazy:"","close-on-content-click":!0,transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"240px"},model:{value:t.menu,callback:function(a){t.menu=a},expression:"menu"}},[e("v-text-field",{attrs:{slot:"activator",label:t.label,readonly:""},on:{keyup:function(a){return"button"in a||!t._k(a.keyCode,"backspace",void 0,a.key,void 0)?t.clear(a):null}},slot:"activator",model:{value:t.formated,callback:function(a){t.formated=a},expression:"formated"}}),t._v(" "),e("v-date-picker",{attrs:{"first-day-of-week":"1","no-title":"",scrollable:"",actions:"",locale:"ru-RU"},on:{input:t.update},model:{value:t.date,callback:function(a){t.date=a},expression:"date"}})],1)},[],!1,null,null,null);l.options.__file="calendar.vue";var r,d=l.exports,c=e(159),f={props:["data"],components:{calendar:d},computed:{jobs:function(){return this.localData.map(function(t){return t.tasks=t.tasks.map(function(t){var a=c.DateTime.fromMillis(t.startDate),e=c.DateTime.fromMillis(t.finishDate),n=c.DateTime.local();return t.startISO=a.toISO(),t.finishISO=e.toISO(),e=e.plus({days:1}),t.interval=c.Interval.fromDateTimes(a,e),t.days=t.interval.count("days"),t.status=null,n<a&&(t.status="waiting"),n>e&&(t.status="done"),t.interval.contains(n)&&(t.status="progress"),t.done&&(t.status="done"),t}),t})},flatData:function(){var t=[];return this.localData.forEach(function(a){a.tasks.forEach(function(a){t.push(a)})}),t},total:function(){var t=Math.min.apply(Math,this.flatData.map(function(t){return t.startDate})),a=c.DateTime.fromMillis(t).startOf("week").plus({days:1}),e=Math.max.apply(Math,this.flatData.map(function(t){return t.finishDate})),n=c.DateTime.fromMillis(e).endOf("week").plus({days:1}),s=c.Interval.fromDateTimes(a,n);t=c.DateTime.fromMillis(t),e=c.DateTime.fromMillis(e);var i=c.Interval.fromDateTimes(t,e).splitBy({days:1}).length;return{interval:s,minDate:t.toISO(),maxDate:e.toISO(),days:i}},weeks:function(){return this.total.interval.splitBy({weeks:1}).map(function(t){return t.start.toISO()})},days:function(){return this.total.interval.splitBy({days:1}).map(function(t){return t.start.toISO()})}},mounted:function(){this.scrollToday()},methods:{isHoliday:function(t){var a=c.DateTime.fromISO(t).weekday;if(1===a||7===a)return!0},isJob:function(t,a){var e=c.DateTime.fromISO(t),n=c.DateTime.local();return!!a.interval.contains(e)&&(a.done?"job done":a.interval.contains(n)&&e>n?"job progress":e<n?"job done":"job waiting")},isToday:function(t){var a=c.DateTime.fromISO(t).minus({days:1});return c.DateTime.local().hasSame(a,"day")},scrollToday:function(){var t=this;this.$nextTick(function(){if(t.$el.querySelector){var a=t.$el.querySelector(".today");a&&(t.$refs.diagram.scrollLeft=a.offsetLeft-700)}})},save:(r=s()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.editable=!1,console.log(this.jobs),alert("API save request");case 3:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)})},data:function(){return{statuses:{progress:"В процессе",done:"Завершено",waiting:"Ожидает"},editable:!1,localData:this.data}},watch:{jobs:function(t){console.log(t)}}},u=(e(151),Object(o.a)(f,function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.editable?e("div",{staticClass:"estimate"},[e("v-expansion-panel",{attrs:{dark:""}},t._l(t.jobs,function(a,n){return e("v-expansion-panel-content",{key:n,staticStyle:{background:"#647d9b"}},[e("div",{staticStyle:{display:"flex"},attrs:{slot:"header"},slot:"header"},[e("div",{staticStyle:{flex:"1","padding-left":"15px"}},[t._v(t._s(n+1)+". "+t._s(a.title))])]),t._v(" "),e("v-card",{attrs:{light:""}},[e("table",{staticClass:"v-datatable v-table theme--light"},[e("thead",[e("tr",[e("th",[t._v("№")]),t._v(" "),e("th",[t._v("Название работ")]),t._v(" "),e("th",[t._v("Начало")]),t._v(" "),e("th",[t._v("Конец")]),t._v(" "),e("th",[t._v("Дней")])])]),t._v(" "),e("tbody",t._l(a.tasks,function(a,s){return e("tr",{key:a.id},[e("td",[t._v(t._s(n+1)+"."+t._s(s+1))]),t._v(" "),e("td",[t._v(t._s(a.name))]),t._v(" "),e("td",[e("calendar",{model:{value:a.startISO,callback:function(e){t.$set(a,"startISO",e)},expression:"job.startISO"}})],1),t._v(" "),e("td",[e("calendar",{model:{value:a.finishISO,callback:function(e){t.$set(a,"finishISO",e)},expression:"job.finishISO"}})],1),t._v(" "),e("td",[e("v-text-field",{staticStyle:{width:"60px"},attrs:{type:"number"},model:{value:a.days,callback:function(e){t.$set(a,"days",e)},expression:"job.days"}})],1)])}))])])],1)})),t._v(" "),e("v-btn",{on:{click:t.save}},[t._v("\n    Сохранить сроки\n  ")])],1):e("div",{ref:"diagram",staticClass:"diagram"},[t.data&&t.data.length>0?e("table",[e("thead",[e("tr",[e("td",{attrs:{colspan:"6"}}),t._v(" "),t._l(t.weeks,function(a,n){return e("td",{key:a,staticClass:"week",attrs:{colspan:"7"}},[e("div",[t._v(t._s(n+1)+" неделя")]),t._v(" "),e("small",[t._v(t._s(t._f("luxon:locale")(a,"d m yyyy")))])])})],2),t._v(" "),e("tr",[e("td",{attrs:{colspan:"6"}}),t._v(" "),t._l(t.days,function(a){return e("td",{key:a,class:{today:t.isToday(a),holiday:t.isHoliday(a)}},[t._v("\n          "+t._s(t._f("luxon:format")(a,"d"))+"\n        ")])})],2)]),t._v(" "),t._l(t.jobs,function(a,n){return e("tbody",{key:a.id},[e("tr",{staticClass:"category"},[e("td"),t._v(" "),e("td",[t._v(t._s(n+1)+".")]),t._v(" "),e("td",[t._v(t._s(a.title))]),t._v(" "),e("td",[t._v("начало")]),t._v(" "),e("td",[t._v("конец")]),t._v(" "),e("td",[t._v("дней")]),t._v(" "),e("td",{staticClass:"spacer",attrs:{colspan:t.days.length}})]),t._v(" "),t._l(a.tasks,function(a,s){return e("tr",{key:s},[e("td",{staticClass:"check-btn"},[a.done?e("v-icon",{attrs:{small:""}},[t._v("check_circle")]):e("v-tooltip",{attrs:{bottom:""}},[e("v-btn",{attrs:{slot:"activator",small:"",icon:""},on:{click:function(t){a.done=!0}},slot:"activator"},[e("v-icon",{attrs:{small:"",color:"grey"}},[t._v("autorenew")])],1),t._v(" "),e("span",[t._v("Пометить как выполненное")])],1)],1),t._v(" "),e("td",{staticClass:"descr"},[t._v(t._s(n+1)+"."+t._s(s+1)+".")]),t._v(" "),e("td",{staticClass:"descr name"},[t._v(t._s(a.name))]),t._v(" "),e("td",{staticClass:"descr date"},[t._v(t._s(t._f("luxon:locale")(a.startISO,"d m yyyy")))]),t._v(" "),e("td",{staticClass:"descr date"},[t._v(t._s(t._f("luxon:locale")(a.finishISO,"d m yyyy")))]),t._v(" "),e("td",{staticClass:"descr",class:a.status},[t._v("\n          "+t._s(a.days)+"\n          "),e("v-tooltip",{attrs:{bottom:""}},[e("v-icon",{attrs:{slot:"activator",small:""},slot:"activator"},[t._v("contact_support")]),t._v(" "),e("span",[t._v(t._s(t.statuses[a.status]))])],1)],1),t._v(" "),t._l(t.days,function(n,s){return e("td",{key:s,class:[t.isJob(n,a),{holiday:t.isHoliday(n),today:t.isToday(n)}],attrs:{title:a.name}})})],2)})],2)}),t._v(" "),e("tbody",{staticClass:"total"},[e("tr",{staticClass:"category"},[e("td"),t._v(" "),e("td"),t._v(" "),e("td",[t._v("Всего")]),t._v(" "),e("td",[t._v(t._s(t._f("luxon:locale")(t.total.minDate,"d m yyyy")))]),t._v(" "),e("td",[t._v(t._s(t._f("luxon:locale")(t.total.maxDate,"d m yyyy")))]),t._v(" "),e("td",[t._v(t._s(t.total.days))]),t._v(" "),e("td",{staticClass:"spacer",attrs:{colspan:t.days.length}},[e("v-btn",{staticStyle:{margin:"0"},attrs:{flat:""},on:{click:function(a){t.editable=!0}}},[t._v("\n            Изменить сроки\n          ")])],1)])])],2):t._e()])},[],!1,null,"2f18ba0f",null));u.options.__file="diagram.vue";a.a=u.exports},160:function(t,a,e){var n=e(185);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,e(23).default)("b27a208c",n,!0,{})},184:function(t,a,e){"use strict";var n=e(160);e.n(n).a},185:function(t,a,e){(t.exports=e(22)(!1)).push([t.i,"",""])},227:function(t,a,e){"use strict";e.r(a);var n={components:{diagram:e(156).a},data:function(){return{data:[{id:1,title:"Внутренний ремонт",tasks:[{id:26,startDate:1543754574847,finishDate:1544727374847,name:"Уборка",done:!0},{id:15,startDate:1544794974847,finishDate:1547177374847,name:"Покраска",done:!1},{id:12,startDate:1545486174847,finishDate:1547177374847,name:"Штукатурные работы",done:!1}]},{id:2,title:"Наружный ремонт",tasks:[{id:15,startDate:1544714974847,finishDate:1547097374847,name:"Покраска",done:!1},{id:12,startDate:1546006174847,finishDate:1547097374847,name:"Штукатурные работы",done:!1}]}]}}},s=(e(184),e(3)),i=Object(s.a)(n,function(){var t=this.$createElement,a=this._self._c||t;return a("v-container",{attrs:{"grid-list-md":"","pa-0":""}},[a("card",{attrs:{title:"Диаграмма"}},[a("diagram",{attrs:{data:this.data}})],1)],1)},[],!1,null,null,null);i.options.__file="diagram.vue";a.default=i.exports}}]);